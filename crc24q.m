parity = uint32(0);

 %C16 10  msg=('010000001010101000110000000000000110001111000000000000000001000100100000101111101110111111001011000101001001011000001101110011010001001100010101011000011111100111011110001110101101101010011100011000000000011110010010101000110100010100111000111101010111010100111110');
   %C16 11 msg=('010000001011101000110000000000000000000000111011001110111000101011101001110001001110010101001001100011100010111110101101101111000000001101010011111111100001111111111101111000111111111111010110000100111111111010101110000000000000010110011111011111111111110101001100');
 %C 37 10 msg=('100101001010101000110000000000000110001111000000000000000001000100100000111111111111101110110100110100101101101010100000000000111000011111101010110100000111110100001010000011110110100101010000000000000000000100010100000000001111010110111000101101010101011101001010');
 %C 37 11 msg=('100101001011101000110000000000000000000000000111001000110011111001011010000001001101100010011011100000110100111011011010111111011110111111010000000000010011101111111111101011000000000010101001100000000000001011010110101000000000010010001000100000000000100100001110');
 %C 38 type 10 msg=('100110001010000111111010010000000110001111000000000000000000100101000100100000110100111101001100100110011100010000010110001111101010110011101110111010111010001110001010011010011010011111101111101010000000001100000001001110100110110100011010011101101110111010100000');
 msg=('100110001011000111111010010000000000000000100101100011001101000000100111100001001111100100100111010111101010111110100110100110000000101000001000000000001010000000000011110110111111100101110100110000000000001010010010001000000000000101001100111111111100011100100011');
%check the length of the input string, in case make it splittable byte-wise
remainder = rem(length(msg),8);
if (remainder ~= 0)
    fill = char(ones(1,8-remainder)*48); %fill string of zeroes
    msg = [fill msg];
end

Nbits = length(msg);

%pre-allocate to increase speed
Nbytes = Nbits / 8;
bytes = cell(1,Nbytes);
k = 1;
for j = 1 : 8 : Nbits
    bytes{k} = msg(j:j+7);
    k = k + 1;
end
%call 'fbin2dec' and 'bitshift' only once (to optimize speed)
bytes = bitshift(fbin2dec(bytes), 16);
bytes = uint32(bytes);
for i = 1 : Nbytes
    parity = bitxor(parity, bytes(i));
    for j = 1 : 8
        parity = bitshift(parity, 1);
        if bitand(parity, 16777216)
            parity = bitxor(parity, 25578747);
        end
    end
end

parity = dec2bin(parity, 24);